{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/IT09/Music/pms/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"C:/Users/IT09/Music/pms/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/IT09/Music/pms/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/IT09/Music/pms/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import axios from\"axios\";import Moment from'moment';import Loader from'./Loader';import DataTable from'react-data-table-component';import{ToastContainer,toast}from'react-toastify';import{useSelector}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AllNotif=function AllNotif(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),pending=_useState2[0],setPending=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var navigate=useNavigate();var _useSelector=useSelector(function(state){return state.auth;}),user=_useSelector.user;var uuid='';if(user!==null){uuid=user.uuid;}var columns=[{name:'ID',selector:function selector(row){return row.kd;},sortable:true},{name:'FROM',selector:function selector(row){return row.name;},sortable:true},{name:'DESCRIPTION',selector:function selector(row){return row.description;},sortable:true,wrap:true},{name:'TYPE',selector:function selector(row){return row.trxtype;},sortable:true},{name:'STATUS',selector:function selector(row){return row.read_status;},sortable:true},{name:'DATE',selector:function selector(row){return row.createdAt;},sortable:true}];var getNotif=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setData([]);_context.prev=1;_context.next=4;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/notif/\").concat(uuid));case 4:response=_context.sent;response.data.forEach(function(items,idx){var dataRow={id:idx,kd:/*#__PURE__*/_jsx(Link,{to:'',onClick:function onClick(){return handleNotifClick(items.foreignid,items.id);},children:items.id},idx),name:items.name,description:items.description,trxtype:items.trxtype.toUpperCase(),read_status:items.read_status?'Read':'Unread',createdAt:Moment(items.createdAt).format('DD-MM-YYYY HH:mm')};setData(function(oldArray){return[].concat(_toConsumableArray(oldArray),[dataRow]);});});_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);toast.error(/*#__PURE__*/_jsxs(\"small\",{children:[\"Gagal reload data notif! msg: \",_context.t0]}),{theme:\"colored\"});setTimeout(function(){window.location.reload();},2000);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function getNotif(){return _ref.apply(this,arguments);};}();useEffect(function(){var timeout=setTimeout(function(){getNotif();setPending(false);},2000);return function(){return clearTimeout(timeout);};},[]);var handleNotifClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(fid,id){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.patch(\"\".concat(process.env.REACT_APP_API_URL,\"/notif/update/\").concat(id));case 3:setTimeout(function(){navigate(\"../projects/detail/\".concat(fid));},1000);_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);toast.error(/*#__PURE__*/_jsxs(\"small\",{children:[\"Gagal update data notif! msg: \",_context2.t0]}),{theme:\"colored\"});setTimeout(function(){window.location.reload();},2000);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleNotifClick(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-sm-flex align-items-center justify-content-between mb-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"h3 mb-3 text-gray-800\",children:\"All Notification Project\"}),/*#__PURE__*/_jsx(\"nav\",{\"aria-label\":\"breadcrumb\",children:/*#__PURE__*/_jsxs(\"ol\",{className:\"breadcrumb\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumb-item\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/dashboard\",children:\"Dashboard\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumb-item active\",\"aria-current\":\"page\",children:\"Notification\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card shadow mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsx(DataTable,{title:\"Notification List\",columns:columns,data:data,progressPending:pending,progressComponent:/*#__PURE__*/_jsx(Loader,{}),pagination:true})})})}),/*#__PURE__*/_jsx(ToastContainer,{icon:false,autoClose:3000})]});};export default AllNotif;","map":null,"metadata":{},"sourceType":"module"}